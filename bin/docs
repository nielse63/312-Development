#!/usr/bin/env bash
set -e

function docs_dev() {
  yarn vuepress dev docs/
}

function docs_lint() {
  echo 'Linting docs files'
  yarn lint:md
  yarn eslint \
    --no-ignore \
    --fix \
    docs/.vuepress/config.js
}

function docs_build() {
  echo 'Compiling docs for deployment'
  docs_lint
  rm -rf docs/.vuepress/dist
  yarn vuepress build docs/
}

function docs_deploy() {
  echo 'Compiling and deploying docs'
  docs_build

  cd docs/.vuepress/dist
  git init
  git add -A
  git commit -m 'deploy'
  # if you are deploying to https://<USERNAME>.github.io/<REPO>
  git push -f git@github.com:nielse63/312-Development.git master:gh-pages
  cd -
}

function usage() {
  echo "runs docs commands"
  echo " "
  echo "bin/docs [command]"
  echo " "
  echo "commands:"
  echo "dev                   starts a vuepress dev server"
  echo "lint                  lints markdown files"
  echo "build                 compiles docs"
  echo "deploy                compiles and deploys docs to GitHub Pages"
  echo " "
  echo "help                  displays usage"
  exit 0
}

if [ "$1" == "dev" ]; then
  docs_dev
elif [ "$1" == "lint" ]; then
  docs_lint
elif [ "$1" == "build" ]; then
  docs_build
elif [ "$1" == "deploy" ]; then
  docs_deploy
elif [ "$1" == "help" ]; then
  usage
else
  usage
  exit 1
fi
